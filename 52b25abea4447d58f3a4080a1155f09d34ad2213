---
type: decisions
timestamp: '2025-12-21T06:03:28.815175+00:00'
summary: '...memories**: Use markers anywhere in your messages:'
---

...memories**: Use markers anywhere in your messages:
- `[remember] <insight>` - Captures a learning
- `[decision] <choice>` - Captures a decision
- `/memory:capture <namespace> <content>` - Explicit capture

**Available...

---
type: decisions
timestamp: '2025-12-21T06:03:28.831978+00:00'
summary: Git notes as source of truth, SQLite as derived queryable index
---

Git notes as source of truth, SQLite as derived queryable index
## Context
Core architectural decision for the memory storage system. Git notes provide distributed, versioned storage that syncs with code, while SQLite + sqlite-vec provides fast KNN search.

## Rationale
- Git notes are inherently distributed (push/pull with repos)
- Version history comes free with git
- Index can be rebuilt from notes (SyncService.reindex)
- sqlite-vec enables local semantic search without external APIs

## Related Files
- docs/spec/completed/2025-12-18-memory-capture-plugin/ARCHITECTURE.md:85-91
- src/git_notes_memory/git_ops.py:1-50
- src/git_notes_memory/sync.py:1-50

---
type: decisions
timestamp: '2025-12-21T06:03:28.850509+00:00'
summary: Lazy loading via __getattr__ to avoid embedding model import penalty
---

Lazy loading via __getattr__ to avoid embedding model import penalty
## Context
The sentence-transformers embedding model adds 2-3 seconds to import time. SessionStart hooks must complete quickly (<5s) to avoid blocking Claude Code sessions.

## Rationale
- Defer all expensive imports until first use
- Factory functions (`get_capture_service()`) create singletons lazily
- Direct SQLite queries in session_start_handler avoid full IndexService initialization

## Related Files
- src/git_notes_memory/__init__.py:27-85
- src/git_notes_memory/hooks/session_start_handler.py:66-89

---
type: decisions
timestamp: '2025-12-21T06:03:28.870963+00:00'
summary: Confidence-based tiered capture behavior (AUTO/SUGGEST/SKIP)
---

Confidence-based tiered capture behavior (AUTO/SUGGEST/SKIP)
## Context
When detecting capture-worthy content, the system needs to balance automation with user control.

## Rationale
- ≥0.95 confidence → AUTO (capture silently, show notification)
- 0.70-0.95 → SUGGEST (show suggestion, user confirms)
- <0.70 → SKIP (no action unless explicit marker)
- Explicit markers like `[decision]` always treated as confidence 0.98-1.0

## Related Files
- docs/spec/completed/2025-12-19-hook-based-memory-capture/DECISIONS.md:226-265
- src/git_notes_memory/hooks/capture_decider.py:128-200

---
type: decisions
timestamp: '2025-12-21T06:03:28.890301+00:00'
summary: Adaptive token budget based on project complexity
---

Adaptive token budget based on project complexity
## Context
SessionStart context injection must balance providing useful context without overwhelming Claude's context window.

## Rationale
- Simple projects (<10 memories): 500 tokens
- Medium (10-50 memories): 1000 tokens
- Complex (50-100 memories): 2000 tokens
- Full (>100 memories): 3000 tokens
- Proportional allocation: 50% blockers, 40% decisions, 10% actions

## Related Files
- docs/spec/completed/2025-12-19-hook-based-memory-capture/DECISIONS.md:145-183
- src/git_notes_memory/hooks/context_builder.py:186-221
- src/git_notes_memory/config.py:536-539

---
type: decisions
timestamp: '2025-12-21T06:05:33.081889+00:00'
summary: '...memories**: Use markers anywhere in your messages:'
---

...memories**: Use markers anywhere in your messages:
- `[remember] <insight>` - Captures a learning
- `[decision] <choice>` - Captures a decision
- `/memory:capture <namespace> <content>` - Explicit capture

**Available...

---
type: decisions
timestamp: '2025-12-21T06:05:33.102411+00:00'
summary: Git notes as source of truth, SQLite as derived queryable index
---

Git notes as source of truth, SQLite as derived queryable index
## Context
Core architectural decision for the memory storage system. Git notes provide distributed, versioned storage that syncs with code, while SQLite + sqlite-vec provides fast KNN search.

## Rationale
- Git notes are inherently distributed (push/pull with repos)
- Version history comes free with git
- Index can be rebuilt from notes (SyncService.reindex)
- sqlite-vec enables local semantic search without external APIs

## Related Files
- docs/spec/completed/2025-12-18-memory-capture-plugin/ARCHITECTURE.md:85-91
- src/git_notes_memory/git_ops.py:1-50
- src/git_notes_memory/sync.py:1-50

---
type: decisions
timestamp: '2025-12-21T06:05:33.123953+00:00'
summary: Lazy loading via __getattr__ to avoid embedding model import penalty
---

Lazy loading via __getattr__ to avoid embedding model import penalty
## Context
The sentence-transformers embedding model adds 2-3 seconds to import time. SessionStart hooks must complete quickly (<5s) to avoid blocking Claude Code sessions.

## Rationale
- Defer all expensive imports until first use
- Factory functions (`get_capture_service()`) create singletons lazily
- Direct SQLite queries in session_start_handler avoid full IndexService initialization

## Related Files
- src/git_notes_memory/__init__.py:27-85
- src/git_notes_memory/hooks/session_start_handler.py:66-89

---
type: decisions
timestamp: '2025-12-21T06:05:33.142973+00:00'
summary: Confidence-based tiered capture behavior (AUTO/SUGGEST/SKIP)
---

Confidence-based tiered capture behavior (AUTO/SUGGEST/SKIP)
## Context
When detecting capture-worthy content, the system needs to balance automation with user control.

## Rationale
- ≥0.95 confidence → AUTO (capture silently, show notification)
- 0.70-0.95 → SUGGEST (show suggestion, user confirms)
- <0.70 → SKIP (no action unless explicit marker)
- Explicit markers like `[decision]` always treated as confidence 0.98-1.0

## Related Files
- docs/spec/completed/2025-12-19-hook-based-memory-capture/DECISIONS.md:226-265
- src/git_notes_memory/hooks/capture_decider.py:128-200

---
type: decisions
timestamp: '2025-12-21T06:05:33.162130+00:00'
summary: Adaptive token budget based on project complexity
---

Adaptive token budget based on project complexity
## Context
SessionStart context injection must balance providing useful context without overwhelming Claude's context window.

## Rationale
- Simple projects (<10 memories): 500 tokens
- Medium (10-50 memories): 1000 tokens
- Complex (50-100 memories): 2000 tokens
- Full (>100 memories): 3000 tokens
- Proportional allocation: 50% blockers, 40% decisions, 10% actions

## Related Files
- docs/spec/completed/2025-12-19-hook-based-memory-capture/DECISIONS.md:145-183
- src/git_notes_memory/hooks/context_builder.py:186-221
- src/git_notes_memory/config.py:536-539

---
type: decisions
timestamp: '2025-12-21T06:05:47.417871+00:00'
summary: '...memories**: Use markers anywhere in your messages:'
---

...memories**: Use markers anywhere in your messages:
- `[remember] <insight>` - Captures a learning
- `[decision] <choice>` - Captures a decision
- `/memory:capture <namespace> <content>` - Explicit capture

**Available...

---
type: decisions
timestamp: '2025-12-21T06:05:47.444336+00:00'
summary: Git notes as source of truth, SQLite as derived queryable index
---

Git notes as source of truth, SQLite as derived queryable index
## Context
Core architectural decision for the memory storage system. Git notes provide distributed, versioned storage that syncs with code, while SQLite + sqlite-vec provides fast KNN search.

## Rationale
- Git notes are inherently distributed (push/pull with repos)
- Version history comes free with git
- Index can be rebuilt from notes (SyncService.reindex)
- sqlite-vec enables local semantic search without external APIs

## Related Files
- docs/spec/completed/2025-12-18-memory-capture-plugin/ARCHITECTURE.md:85-91
- src/git_notes_memory/git_ops.py:1-50
- src/git_notes_memory/sync.py:1-50

---
type: decisions
timestamp: '2025-12-21T06:05:47.469143+00:00'
summary: Lazy loading via __getattr__ to avoid embedding model import penalty
---

Lazy loading via __getattr__ to avoid embedding model import penalty
## Context
The sentence-transformers embedding model adds 2-3 seconds to import time. SessionStart hooks must complete quickly (<5s) to avoid blocking Claude Code sessions.

## Rationale
- Defer all expensive imports until first use
- Factory functions (`get_capture_service()`) create singletons lazily
- Direct SQLite queries in session_start_handler avoid full IndexService initialization

## Related Files
- src/git_notes_memory/__init__.py:27-85
- src/git_notes_memory/hooks/session_start_handler.py:66-89

---
type: decisions
timestamp: '2025-12-21T06:05:47.488552+00:00'
summary: Confidence-based tiered capture behavior (AUTO/SUGGEST/SKIP)
---

Confidence-based tiered capture behavior (AUTO/SUGGEST/SKIP)
## Context
When detecting capture-worthy content, the system needs to balance automation with user control.

## Rationale
- ≥0.95 confidence → AUTO (capture silently, show notification)
- 0.70-0.95 → SUGGEST (show suggestion, user confirms)
- <0.70 → SKIP (no action unless explicit marker)
- Explicit markers like `[decision]` always treated as confidence 0.98-1.0

## Related Files
- docs/spec/completed/2025-12-19-hook-based-memory-capture/DECISIONS.md:226-265
- src/git_notes_memory/hooks/capture_decider.py:128-200

---
type: decisions
timestamp: '2025-12-21T06:05:47.507345+00:00'
summary: Adaptive token budget based on project complexity
---

Adaptive token budget based on project complexity
## Context
SessionStart context injection must balance providing useful context without overwhelming Claude's context window.

## Rationale
- Simple projects (<10 memories): 500 tokens
- Medium (10-50 memories): 1000 tokens
- Complex (50-100 memories): 2000 tokens
- Full (>100 memories): 3000 tokens
- Proportional allocation: 50% blockers, 40% decisions, 10% actions

## Related Files
- docs/spec/completed/2025-12-19-hook-based-memory-capture/DECISIONS.md:145-183
- src/git_notes_memory/hooks/context_builder.py:186-221
- src/git_notes_memory/config.py:536-539

---
type: decisions
timestamp: '2025-12-21T06:10:03.879629+00:00'
summary: '...memories**: Use markers anywhere in your messages:'
---

...memories**: Use markers anywhere in your messages:
- `[remember] <insight>` - Captures a learning
- `[decision] <choice>` - Captures a decision
- `/memory:capture <namespace> <content>` - Explicit capture

**Available...

---
type: decisions
timestamp: '2025-12-21T06:10:03.901593+00:00'
summary: Git notes as source of truth, SQLite as derived queryable index
---

Git notes as source of truth, SQLite as derived queryable index
## Context
Core architectural decision for the memory storage system. Git notes provide distributed, versioned storage that syncs with code, while SQLite + sqlite-vec provides fast KNN search.

## Rationale
- Git notes are inherently distributed (push/pull with repos)
- Version history comes free with git
- Index can be rebuilt from notes (SyncService.reindex)
- sqlite-vec enables local semantic search without external APIs

## Related Files
- docs/spec/completed/2025-12-18-memory-capture-plugin/ARCHITECTURE.md:85-91
- src/git_notes_memory/git_ops.py:1-50
- src/git_notes_memory/sync.py:1-50
