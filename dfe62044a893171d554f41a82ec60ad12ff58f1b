---
type: patterns
timestamp: '2025-12-26T00:00:15.697553+00:00'
summary: '...functionality |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...functionality |
| Graceful degradation | Silent fallback if monitoring unavailable | Optional extras pattern |
| Thread safety | Full thread-safe metrics | Concurrent hook invocations |

## Technical...

---
type: patterns
timestamp: '2025-12-26T00:00:15.721501+00:00'
summary: '...timeout mechanism |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...timeout mechanism |
| Service singletons | Inject metrics collector | Use existing factory pattern |

## Dependencies

### Internal Dependencies

| Dependency | Type | Notes |
|------------|------|--...

---
type: patterns
timestamp: '2025-12-26T00:01:27.869261+00:00'
summary: '...user/index.db`'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...user/index.db`
  - [ ] Functions create directories if they don't exist
- **Notes**: Use existing XDG pattern from `get_index_path()`

#### Task 1.2: Extend Memory Model with Domain Field
- **Description**:...

---
type: patterns
timestamp: '2025-12-26T00:01:27.899157+00:00'
summary: '...- [ ] Migration runs cleanly on existing databases'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...- [ ] Migration runs cleanly on existing databases
- **Notes**: Follow existing migration pattern from version 2

#### Task 1.4: Update IndexService for Domain
- **Description**: Extend IndexService...

---
type: patterns
timestamp: '2025-12-26T00:01:27.926768+00:00'
summary: '...repo (existing behavior)'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...repo (existing behavior)
  - [ ] Instance cached per domain
- **Notes**: Consider singleton pattern per domain

#### Task 2.2: Initialize User-Memories Bare Repo
- **Description**: Create and...

---
type: patterns
timestamp: '2025-12-26T00:01:27.953489+00:00'
summary: '...behavior across methods'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...behavior across methods
  - [ ] `get_stats()` returns counts by domain
- **Notes**: Follow same pattern as Task 2.3

### Phase 2 Deliverables
- [ ] GitOps domain factory
- [ ] User-memories bare...

---
type: patterns
timestamp: '2025-12-26T00:01:27.981836+00:00'
summary: '...Lazy initialization - only creates on first use'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...Lazy initialization - only creates on first use
- **Notes**: Follow existing service registry pattern

#### Task 3.3: Extend RecallService for Multi-Domain Search
- **Description**: Modify `search()`...

---
type: patterns
timestamp: '2025-12-26T00:01:28.011697+00:00'
summary: '...complete'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...complete

### Tasks

#### Task 4.1: Add Domain Markers to SignalDetector
- **Description**: Extend pattern matching to recognize domain markers
- **Acceptance Criteria**:
  - [ ] `[global]` and `[user]`...

---
type: patterns
timestamp: '2025-12-26T00:01:28.040054+00:00'
summary: '...appropriate for markers'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...appropriate for markers
- **Notes**: Add to `SIGNAL_PATTERNS` dict

#### Task 4.2: Extend Block Pattern for Domain Prefix
- **Description**: Support `▶ global:decision ───` format
- **Acceptance...

---
type: patterns
timestamp: '2025-12-26T00:01:28.067083+00:00'
summary: '...**Description**: Support `▶ global:decision ───` format'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...**Description**: Support `▶ global:decision ───` format
- **Acceptance Criteria**:
  - [ ] Block pattern regex updated for optional domain prefix
  - [ ] `global:`, `user:` prefix sets USER domain...

---
type: patterns
timestamp: '2025-12-26T00:01:28.096724+00:00'
summary: '...XMLBuilder.add_memory_element()`'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...XMLBuilder.add_memory_element()`

### Phase 4 Deliverables
- [ ] Domain marker detection
- [ ] Block pattern with domain prefix
- [ ] Handler integration
- [ ] Multi-domain context building
- [ ] Tests...

---
type: patterns
timestamp: '2025-12-26T00:06:36.570787+00:00'
summary: '...Output format: `text`, `json`, `prometheus` | `text` |'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Output format: `text`, `json`, `prometheus` | `text` |
| `--filter` | Filter by metric name pattern | None |
| `--since` | Show metrics since timestamp | None |

**Example Output (text)**:
```
Memory...

---
type: patterns
timestamp: '2025-12-26T00:06:52.966236+00:00'
summary: '...**deterministic prefixes** and are highly reliable with minimal false
  positives:'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...**deterministic prefixes** and are highly reliable with minimal false positives:

| Provider | Pattern | Regex | Notes |
|----------|---------|-------|-------|
| **OpenAI** | `sk-` prefix (legacy)...

---
type: patterns
timestamp: '2025-12-26T00:06:52.996073+00:00'
summary: '...Strategy'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...Strategy

**Recommended approach for git-notes-memory**:

1. **Pattern-first**: If a deterministic pattern matches, skip entropy check (already high confidence)
2. **Entropy as secondary**: Use entropy...

---
type: patterns
timestamp: '2025-12-26T00:06:53.022767+00:00'
summary: '...detection_method: str     # "pattern" | "entropy" | "contextual"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...detection_method: str     # "pattern" | "entropy" | "contextual"
    pattern_id: str | None    # Which pattern matched

    # WHERE
    source_location: str      # File path or capture source
    memory_namespace...

---
type: patterns
timestamp: '2025-12-26T00:06:53.049566+00:00'
summary: '....memory-secrets-allowlist.yaml'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

....memory-secrets-allowlist.yaml
version: 1

# Global allowlist patterns
global:
  patterns:
    - pattern: "AKIA.*EXAMPLE"
      reason: "Documentation example"
      added_by: "user@example.com"...

---
type: patterns
timestamp: '2025-12-26T00:06:53.077725+00:00'
summary: '...expires: "2024-06-01"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...expires: "2024-06-01"

# Per-namespace allowlists
namespaces:
  learnings:
    patterns:
      - pattern: "sk-ant-api.*for-testing"
        reason: "Learning about API key formats"

# Temporary suppressions...

---
type: patterns
timestamp: '2025-12-26T00:06:53.105961+00:00'
summary: '..."Learning about API key formats"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

..."Learning about API key formats"

# Temporary suppressions (require expiry)
temporary:
  - pattern: "ghp_[a-zA-Z0-9]{36}"
    reason: "Documenting GitHub token format change"
    expires: "2024-02-01...

---
type: patterns
timestamp: '2025-12-26T00:06:53.135540+00:00'
summary: '...123"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...123"
```

---

## 5. PII Detection Patterns

### 5.1 US Social Security Numbers (SSN)

```python
# SSN Pattern: XXX-XX-XXXX
SSN_PATTERN = r'\b(?!000|666|9\d{2})\d{3}-(?!00)\d{2}-(?!0000)\d{4}\b'

# Validation...

---
type: patterns
timestamp: '2025-12-26T00:06:53.165181+00:00'
summary: '...644-649, 65'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...644-649, 65
    "discover": r'\b(?:6011|65[0-9]{2}|64[4-9][0-9])[0-9]{12,15}\b',
}

# Combined pattern with common separators
CREDIT_CARD_COMBINED = r'\b(?:\d{4}[- ]?){3}\d{4}\b'
```

**Luhn Algorithm...

---
type: patterns
timestamp: '2025-12-26T00:06:53.192405+00:00'
summary: '...\s]?|0)(?:\d[-.\s]?){9,10}\b'','
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...\s]?|0)(?:\d[-.\s]?){9,10}\b',
}
```

### 5.4 Email Addresses

```python
# RFC 5322 compliant email pattern (simplified)
EMAIL_PATTERN = r'\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}\b'

# More...
