---
type: patterns
timestamp: '2025-12-26T00:00:15.697553+00:00'
summary: '...functionality |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...functionality |
| Graceful degradation | Silent fallback if monitoring unavailable | Optional extras pattern |
| Thread safety | Full thread-safe metrics | Concurrent hook invocations |

## Technical...

---
type: patterns
timestamp: '2025-12-26T00:00:15.721501+00:00'
summary: '...timeout mechanism |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...timeout mechanism |
| Service singletons | Inject metrics collector | Use existing factory pattern |

## Dependencies

### Internal Dependencies

| Dependency | Type | Notes |
|------------|------|--...

---
type: patterns
timestamp: '2025-12-26T00:01:27.869261+00:00'
summary: '...user/index.db`'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...user/index.db`
  - [ ] Functions create directories if they don't exist
- **Notes**: Use existing XDG pattern from `get_index_path()`

#### Task 1.2: Extend Memory Model with Domain Field
- **Description**:...

---
type: patterns
timestamp: '2025-12-26T00:01:27.899157+00:00'
summary: '...- [ ] Migration runs cleanly on existing databases'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...- [ ] Migration runs cleanly on existing databases
- **Notes**: Follow existing migration pattern from version 2

#### Task 1.4: Update IndexService for Domain
- **Description**: Extend IndexService...

---
type: patterns
timestamp: '2025-12-26T00:01:27.926768+00:00'
summary: '...repo (existing behavior)'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...repo (existing behavior)
  - [ ] Instance cached per domain
- **Notes**: Consider singleton pattern per domain

#### Task 2.2: Initialize User-Memories Bare Repo
- **Description**: Create and...

---
type: patterns
timestamp: '2025-12-26T00:01:27.953489+00:00'
summary: '...behavior across methods'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...behavior across methods
  - [ ] `get_stats()` returns counts by domain
- **Notes**: Follow same pattern as Task 2.3

### Phase 2 Deliverables
- [ ] GitOps domain factory
- [ ] User-memories bare...

---
type: patterns
timestamp: '2025-12-26T00:01:27.981836+00:00'
summary: '...Lazy initialization - only creates on first use'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...Lazy initialization - only creates on first use
- **Notes**: Follow existing service registry pattern

#### Task 3.3: Extend RecallService for Multi-Domain Search
- **Description**: Modify `search()`...

---
type: patterns
timestamp: '2025-12-26T00:01:28.011697+00:00'
summary: '...complete'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...complete

### Tasks

#### Task 4.1: Add Domain Markers to SignalDetector
- **Description**: Extend pattern matching to recognize domain markers
- **Acceptance Criteria**:
  - [ ] `[global]` and `[user]`...

---
type: patterns
timestamp: '2025-12-26T00:01:28.040054+00:00'
summary: '...appropriate for markers'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...appropriate for markers
- **Notes**: Add to `SIGNAL_PATTERNS` dict

#### Task 4.2: Extend Block Pattern for Domain Prefix
- **Description**: Support `▶ global:decision ───` format
- **Acceptance...

---
type: patterns
timestamp: '2025-12-26T00:01:28.067083+00:00'
summary: '...**Description**: Support `▶ global:decision ───` format'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...**Description**: Support `▶ global:decision ───` format
- **Acceptance Criteria**:
  - [ ] Block pattern regex updated for optional domain prefix
  - [ ] `global:`, `user:` prefix sets USER domain...

---
type: patterns
timestamp: '2025-12-26T00:01:28.096724+00:00'
summary: '...XMLBuilder.add_memory_element()`'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...XMLBuilder.add_memory_element()`

### Phase 4 Deliverables
- [ ] Domain marker detection
- [ ] Block pattern with domain prefix
- [ ] Handler integration
- [ ] Multi-domain context building
- [ ] Tests...

---
type: patterns
timestamp: '2025-12-26T00:06:36.570787+00:00'
summary: '...Output format: `text`, `json`, `prometheus` | `text` |'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Output format: `text`, `json`, `prometheus` | `text` |
| `--filter` | Filter by metric name pattern | None |
| `--since` | Show metrics since timestamp | None |

**Example Output (text)**:
```
Memory...

---
type: patterns
timestamp: '2025-12-26T00:06:52.966236+00:00'
summary: '...**deterministic prefixes** and are highly reliable with minimal false
  positives:'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...**deterministic prefixes** and are highly reliable with minimal false positives:

| Provider | Pattern | Regex | Notes |
|----------|---------|-------|-------|
| **OpenAI** | `sk-` prefix (legacy)...

---
type: patterns
timestamp: '2025-12-26T00:06:52.996073+00:00'
summary: '...Strategy'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...Strategy

**Recommended approach for git-notes-memory**:

1. **Pattern-first**: If a deterministic pattern matches, skip entropy check (already high confidence)
2. **Entropy as secondary**: Use entropy...

---
type: patterns
timestamp: '2025-12-26T00:06:53.022767+00:00'
summary: '...detection_method: str     # "pattern" | "entropy" | "contextual"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...detection_method: str     # "pattern" | "entropy" | "contextual"
    pattern_id: str | None    # Which pattern matched

    # WHERE
    source_location: str      # File path or capture source
    memory_namespace...

---
type: patterns
timestamp: '2025-12-26T00:06:53.049566+00:00'
summary: '....memory-secrets-allowlist.yaml'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

....memory-secrets-allowlist.yaml
version: 1

# Global allowlist patterns
global:
  patterns:
    - pattern: "AKIA.*EXAMPLE"
      reason: "Documentation example"
      added_by: "user@example.com"...

---
type: patterns
timestamp: '2025-12-26T00:06:53.077725+00:00'
summary: '...expires: "2024-06-01"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...expires: "2024-06-01"

# Per-namespace allowlists
namespaces:
  learnings:
    patterns:
      - pattern: "sk-ant-api.*for-testing"
        reason: "Learning about API key formats"

# Temporary suppressions...

---
type: patterns
timestamp: '2025-12-26T00:06:53.105961+00:00'
summary: '..."Learning about API key formats"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

..."Learning about API key formats"

# Temporary suppressions (require expiry)
temporary:
  - pattern: "ghp_[a-zA-Z0-9]{36}"
    reason: "Documenting GitHub token format change"
    expires: "2024-02-01...

---
type: patterns
timestamp: '2025-12-26T00:06:53.135540+00:00'
summary: '...123"'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...123"
```

---

## 5. PII Detection Patterns

### 5.1 US Social Security Numbers (SSN)

```python
# SSN Pattern: XXX-XX-XXXX
SSN_PATTERN = r'\b(?!000|666|9\d{2})\d{3}-(?!00)\d{2}-(?!0000)\d{4}\b'

# Validation...

---
type: patterns
timestamp: '2025-12-26T00:06:53.165181+00:00'
summary: '...644-649, 65'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...644-649, 65
    "discover": r'\b(?:6011|65[0-9]{2}|64[4-9][0-9])[0-9]{12,15}\b',
}

# Combined pattern with common separators
CREDIT_CARD_COMBINED = r'\b(?:\d{4}[- ]?){3}\d{4}\b'
```

**Luhn Algorithm...

---
type: patterns
timestamp: '2025-12-26T00:06:53.192405+00:00'
summary: '...\s]?|0)(?:\d[-.\s]?){9,10}\b'','
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...\s]?|0)(?:\d[-.\s]?){9,10}\b',
}
```

### 5.4 Email Addresses

```python
# RFC 5322 compliant email pattern (simplified)
EMAIL_PATTERN = r'\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}\b'

# More...

---
type: patterns
timestamp: '2025-12-26T00:06:53.220221+00:00'
summary: '...''pwd'','
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...'pwd',
    'secret',
    'contraseña',  # Spanish
    'contrasena',
)
```

### 6.2 Assignment Pattern Detection

```python
# Value follows keyword pattern
FOLLOWED_BY_EQUAL = r'{keyword}["\']?\s*[:=]\s*...

---
type: patterns
timestamp: '2025-12-26T00:06:53.244552+00:00'
summary: '...''contrasena'','
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...'contrasena',
)
```

### 6.2 Assignment Pattern Detection

```python
# Value follows keyword pattern
FOLLOWED_BY_EQUAL = r'{keyword}["\']?\s*[:=]\s*["\']?({secret})'

# Examples matched:
# password...

---
type: patterns
timestamp: '2025-12-26T00:06:53.272541+00:00'
summary: '...sk-ant-api03-...'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...sk-ant-api03-...
# database_pass := 'mypass'
# secret => "value"
```

### 6.3 File Context

| File Pattern | Context | Sensitivity Adjustment |
|--------------|---------|----------------------|
| `.env*`...

---
type: patterns
timestamp: '2025-12-26T00:06:53.299964+00:00'
summary: '...7.1 Detection Pipeline Architecture'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...7.1 Detection Pipeline Architecture

```
Input Content
    |
    v
[Layer 1: Deterministic Pattern Matching]
    |-- OpenAI, Anthropic, GitHub, AWS, Slack, etc.
    |-- Private keys (BEGIN...PRIVATE...

---
type: patterns
timestamp: '2025-12-26T00:06:53.327836+00:00'
summary: '...content)'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...content)
```

### 7.2 Recommended Default Configuration

```yaml
secrets_filter:
  enabled: true

  # Pattern detection
  patterns:
    enabled: true
    providers:
      - openai
      - anthropic...

---
type: patterns
timestamp: '2025-12-26T00:06:53.357196+00:00'
summary: '...Operation | Expected Time | Optimization |'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...Operation | Expected Time | Optimization |
|-----------|---------------|--------------|
| Pattern matching | <1ms per pattern | Compile regex once, reuse |
| Entropy calculation | <0.1ms |...

---
type: patterns
timestamp: '2025-12-26T00:06:53.386686+00:00'
summary: '...Optimization |'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...Optimization |
|-----------|---------------|--------------|
| Pattern matching | <1ms per pattern | Compile regex once, reuse |
| Entropy calculation | <0.1ms | Cache charset lookups |
| Full...

---
type: patterns
timestamp: '2025-12-26T00:06:53.415403+00:00'
summary: '...and Privacy Controls'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...and Privacy Controls
   - AU-2: Event Logging
   - AU-3: Content of Audit Records

### 8.3 Pattern Sources

1. **gitleaks.toml** (v8.25.0): https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks...

---
type: patterns
timestamp: '2025-12-26T00:06:53.442942+00:00'
summary: '...---------|'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...---------|
| **Entropy Threshold** | 3.0 hex / 4.5 base64 | Industry standard, balanced FP/FN |
| **Pattern Priority** | Deterministic first | Highest confidence, fastest |
| **Keyword Context** | Required...

---
type: patterns
timestamp: '2025-12-26T00:07:20.092457+00:00'
summary: '...handling'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...handling

**Acceptance Criteria**:
- Protocol is runtime-checkable
- Supports async/await pattern
- Clear interface documentation

#### 1.4 Implement Anthropic provider
- [ ] Create `src/git_notes_memory...

---
type: patterns
timestamp: '2025-12-26T00:07:20.123409+00:00'
summary: '...environment'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...environment
- [ ] Implement retry with exponential backoff
- [ ] Support JSON mode via tool_use pattern

**Acceptance Criteria**:
- Works with `anthropic` SDK
- Graceful degradation if SDK not installed
-...

---
type: patterns
timestamp: '2025-12-26T00:07:20.152204+00:00'
summary: '...triggers'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...triggers
- [ ] File access trigger
- [ ] Error message trigger
- [ ] Topic mention trigger
- [ ] Pattern match trigger

**Acceptance Criteria**:
- Multiple triggers
- Configurable
- Fast detection

####...

---
type: patterns
timestamp: '2025-12-26T00:08:37.601494+00:00'
summary: '...filtering'
tags:
- auto-captured
- post-tool-use
- file:IMPLEMENTATION_PLAN.md
---

...filtering
  - [ ] Tests verify all output formats
- **Implementation**: Use command handler pattern from existing commands

#### Task 4.2: Implement Prometheus text format export

- **Description**:...

---
type: patterns
timestamp: '2025-12-26T00:08:59.009792+00:00'
summary: '...local models'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...local models

**Decision**:
Implement a provider-agnostic LLM client using Python's Protocol pattern:
- `LLMProvider` protocol defines the interface
- `AnthropicProvider`, `OpenAIProvider`, `OllamaProvider...

---
type: patterns
timestamp: '2025-12-26T00:08:59.037818+00:00'
summary: '...**Manual archival only**: No automation benefit'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...**Manual archival only**: No automation benefit

---

## ADR-009: Adversarial Detection with Pattern Matching First

**Status**: Accepted

**Context**:
Memory poisoning is a security concern (per...

---
type: patterns
timestamp: '2025-12-26T00:08:59.065403+00:00'
summary: '...capture.'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...capture.

**Decision**:
Implement two-tier adversarial detection:
1. **Fast path (regex)**: Pattern match for known injection patterns
2. **Slow path (LLM)**: Deep analysis for contradictions,...

---
type: patterns
timestamp: '2025-12-26T00:08:59.091683+00:00'
summary: '...**Negative**: Regex can''t catch novel attacks'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...**Negative**: Regex can't catch novel attacks
- **Negative**: False positives possible with pattern matching

**Alternatives Considered**:
1. **LLM-only**: Too slow for every capture
2. **No...

---
type: patterns
timestamp: '2025-12-26T00:08:59.116593+00:00'
summary: '...formula with weighted factors |'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...formula with weighted factors |
| 009 | 2025-12-26 | Accepted | Adversarial detection with pattern matching first |
| 010 | 2025-12-26 | Accepted | Proactive surfacing rate limiting |
| 011...

---
type: patterns
timestamp: '2025-12-26T00:09:15.695241+00:00'
summary: '...Metrics'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...Metrics

| Metric | Target | Measurement Method |
|--------|--------|-------------------|
| Pattern detection coverage | >95% of common secret formats | Test against known secret formats |
|...

---
type: patterns
timestamp: '2025-12-26T00:09:15.726186+00:00'
summary: '...analysis | Understand JSON/YAML structure | Parse structured formats
  for keys |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...analysis | Understand JSON/YAML structure | Parse structured formats for keys |
| FR-203 | Custom pattern file | Organization-specific patterns | Load patterns from external YAML |
| FR-204 | Metrics/telemetry...

---
type: patterns
timestamp: '2025-12-26T00:09:15.753400+00:00'
summary: '...Performance'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...Performance

- **Filtering latency**: <10ms per capture operation
- **Memory overhead**: <50MB for pattern compilation
- **Startup time**: Lazy initialization, no impact on import time
- **Batch scanning**:...

---
type: patterns
timestamp: '2025-12-26T00:09:15.780561+00:00'
summary: '...degradation**: Capture succeeds with warning if filtering fails'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...degradation**: Capture succeeds with warning if filtering fails

### Maintainability

- **Pattern updates**: Patterns in separate module for easy updates
- **Test coverage**: >90% coverage...

---
type: patterns
timestamp: '2025-12-26T00:09:15.809078+00:00'
summary: '...|'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...|
| Performance regression | Low | Medium | Lazy compilation, benchmark tests |
| Incomplete pattern coverage | Medium | High | Extensible pattern system, updates |
| Allowlist bypass | Low |...

---
type: patterns
timestamp: '2025-12-26T00:09:15.834888+00:00'
summary: '...compilation, benchmark tests |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...compilation, benchmark tests |
| Incomplete pattern coverage | Medium | High | Extensible pattern system, updates |
| Allowlist bypass | Low | High | Hash-based storage, no plaintext |

##...

---
type: patterns
timestamp: '2025-12-26T00:09:15.859511+00:00'
summary: '...Hash-based storage, no plaintext |'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...Hash-based storage, no plaintext |

## Open Questions

- [x] Which detection layers in v1? → Pattern + Entropy (confirmed)
- [x] Include PII? → Yes (confirmed)
- [x] Default strategy? → REDACT...

---
type: patterns
timestamp: '2025-12-26T00:09:15.887818+00:00'
summary: '...Management](https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html)'
tags:
- auto-captured
- post-tool-use
- file:REQUIREMENTS.md
---

...Management](https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html)

### Secret Pattern Categories

| Category | Examples | Detection Method |
|----------|----------|------------------|
|...

---
type: patterns
timestamp: '2025-12-26T00:09:56.535769+00:00'
summary: '...ADR-008: Decay score formula with weighted factors'
tags:
- auto-captured
- post-tool-use
- file:CHANGELOG.md
---

...ADR-008: Decay score formula with weighted factors
  - ADR-009: Adversarial detection with pattern matching first
  - ADR-010: Proactive surfacing rate limiting
  - ADR-011: Meta-memory for...

---
type: patterns
timestamp: '2025-12-26T00:09:59.067800+00:00'
summary: '...Claude Code hooks with strict timeout constraints.'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...Claude Code hooks with strict timeout constraints.

### Decision

Use Python's `extras_require` pattern to make observability dependencies optional:

```toml
[project.optional-dependencies]
monitoring...

---
type: patterns
timestamp: '2025-12-26T00:09:59.094786+00:00'
summary: '...throughout codebase'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...throughout codebase
3. **Global state**: Rejected - not thread-safe

---

## ADR-006: Decorator Pattern for Timing

**Date**: 2025-12-25
**Status**: Accepted
**Deciders**: Claude (technical decision)

###...

---
type: patterns
timestamp: '2025-12-26T00:09:59.121908+00:00'
summary: '...Cannot instrument mid-function without refactoring'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...Cannot instrument mid-function without refactoring
- Decorator order matters

**Neutral:**
- Pattern is familiar to Python developers

### Alternatives Considered

1. **Context managers everywhere**:...

---
type: patterns
timestamp: '2025-12-26T00:09:59.149846+00:00'
summary: '...calculation**: Rejected - complexity, requires warmup period'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...calculation**: Rejected - complexity, requires warmup period

---

## ADR-008: Graceful Degradation Pattern

**Date**: 2025-12-25
**Status**: Accepted
**Deciders**: Claude (technical decision)

### Context

Observability...

---
type: patterns
timestamp: '2025-12-26T00:09:59.178157+00:00'
summary: '...operating.'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...operating.

### Decision

Implement graceful degradation at all integration points:

```python
# Import pattern
try:
    from opentelemetry.sdk.trace import TracerProvider
    OTEL_AVAILABLE = True
except...

---
type: patterns
timestamp: '2025-12-26T00:09:59.206580+00:00'
summary: '...TracerProvider'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...TracerProvider
    OTEL_AVAILABLE = True
except ImportError:
    OTEL_AVAILABLE = False

# Usage pattern
def export_traces(spans: list[Span]) -> None:
    if not OTEL_AVAILABLE:
        return  #...

---
type: patterns
timestamp: '2025-12-26T00:09:59.255284+00:00'
summary: '...Claude'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...Claude

### Context

New CLI commands need consistent naming. Existing commands follow `/memory:*` pattern (e.g., `/memory:capture`, `/memory:recall`). Observability commands could follow the same pattern...

---
type: patterns
timestamp: '2025-12-26T00:09:59.282307+00:00'
summary: '...(e.g., `/memory:capture`, `/memory:recall`). Observability commands could
  follow the same pattern'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...(e.g., `/memory:capture`, `/memory:recall`). Observability commands could follow the same pattern or use a sub-namespace.

### Decision

Use `/memory:*` pattern for observability commands:

-...

---
type: patterns
timestamp: '2025-12-26T00:09:59.308133+00:00'
summary: '...commands could follow the same pattern or use a sub-namespace.'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...commands could follow the same pattern or use a sub-namespace.

### Decision

Use `/memory:*` pattern for observability commands:

- `/memory:metrics` - View metrics
- `/memory:traces` - View traces
-...

---
type: patterns
timestamp: '2025-12-26T00:11:10.347774+00:00'
summary: '...only depend on `opentelemetry-api`'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...only depend on `opentelemetry-api`
   - SDK is application's choice
   - Follows our extras pattern perfectly

2. **Version Compatibility**:
   - Use `~= 1.32.0` style for tight compatibility...

---
type: patterns
timestamp: '2025-12-26T00:11:10.376095+00:00'
summary: '...Callback-based |'
tags:
- auto-captured
- post-tool-use
- file:RESEARCH_NOTES.md
---

...Callback-based |

### Common Patterns Identified

1. **Decorator-based timing** - Universal pattern
2. **Optional dependencies** - Standard for plugins/libraries
3. **Graceful degradation** -...

---
type: patterns
timestamp: '2025-12-26T00:12:04.360058+00:00'
summary: '...**Learnings** - Technical insights, debugging discoveries, "TIL" moments'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...**Learnings** - Technical insights, debugging discoveries, "TIL" moments
3. **Patterns** - Reusable approaches, best practices, anti-patterns
4. **Blockers** - Problems encountered and their...

---
type: patterns
timestamp: '2025-12-26T00:12:04.413745+00:00'
summary: '...related memories:'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...related memories:
{cluster_memories}

Create a meta-memory that:
1. Captures the essential pattern or theme
2. Preserves key details from each source
3. Uses SUMMARY level for quick recall
4....

---
type: patterns
timestamp: '2025-12-26T00:12:08.520007+00:00'
summary: '...metrics with rolling window'
tags:
- auto-captured
- post-tool-use
- file:CHANGELOG.md
---

...metrics with rolling window
  - ADR-005: Contextvars for span propagation
  - ADR-006: Decorator pattern for timing
  - ADR-007: Prometheus histogram bucket configuration
  - ADR-008: Graceful degradation...

---
type: patterns
timestamp: '2025-12-26T00:12:08.549354+00:00'
summary: '...timing'
tags:
- auto-captured
- post-tool-use
- file:CHANGELOG.md
---

...timing
  - ADR-007: Prometheus histogram bucket configuration
  - ADR-008: Graceful degradation pattern
  - ADR-009: Command naming convention

- Codebase analysis and research findings (RESEARCH_NOTES.md...

---
type: patterns
timestamp: '2025-12-26T00:12:10.504237+00:00'
summary: '...self._compiled = {'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...self._compiled = {
            name: re.compile(pattern.regex)
            for name, pattern in self.PATTERNS.items()
        }

    def detect(self, text: str) -> list[Detection]:...

---
type: patterns
timestamp: '2025-12-26T00:12:10.533717+00:00'
summary: '...PATTERNS.items()'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...PATTERNS.items()
        }

    def detect(self, text: str) -> list[Detection]:
        """Scan text for pattern matches."""
        detections = []
        for name, compiled in self._compiled.items():...

---
type: patterns
timestamp: '2025-12-26T00:12:10.564544+00:00'
summary: '...matches."""'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...matches."""
        detections = []
        for name, compiled in self._compiled.items():
            pattern = self.PATTERNS[name]
            for match in compiled.finditer(text):
                detections.append...

---
type: patterns
timestamp: '2025-12-26T00:12:10.592214+00:00'
summary: '...pattern.finditer(text):'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...pattern.finditer(text):
            token = match.group()

            # Check if already covered by pattern detector
            # (entropy is fallback for unknown formats)

            # Try base64...

---
type: patterns
timestamp: '2025-12-26T00:12:10.624552+00:00'
summary: '...Dependencies**: None'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Dependencies**: None
- **Technology**: Regex + Luhn algorithm

```python
class PIIDetector:
    """PII pattern detection."""

    def __init__(self) -> None:
        self._ssn_pattern = re.compile(r"\b\d{3}-\d{2...

---
type: patterns
timestamp: '2025-12-26T00:12:10.650616+00:00'
summary: '...Phone numbers, potential false positives'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Phone numbers, potential false positives

@dataclass(frozen=True)
class SecretPattern:
    """Pattern definition for detection."""
    regex: str
    confidence: float
    severity: Severity...

---
type: patterns
timestamp: '2025-12-26T00:12:10.678932+00:00'
summary: '...Considerations'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Considerations

### Expected Load

- Captures per session: 10-50
- Content size: Up to 100KB
- Pattern count: ~20 patterns

### Performance Targets

| Metric | Target | Rationale |
|--------|--------|---...

---
type: patterns
timestamp: '2025-12-26T00:12:10.707279+00:00'
summary: '...patterns'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...patterns

### Performance Targets

| Metric | Target | Rationale |
|--------|--------|-----------|
| Pattern matching | <5ms per capture | Compiled regex, efficient |
| Entropy calculation | <3ms per...

---
type: patterns
timestamp: '2025-12-26T00:12:10.738293+00:00'
summary: '...Total filtering | <10ms per capture | Combined all detectors |'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Total filtering | <10ms per capture | Combined all detectors |
| Memory overhead | <50MB | Pattern compilation cache |

### Optimization Strategies

1. **Lazy initialization**: Don't load patterns...

---
type: patterns
timestamp: '2025-12-26T00:12:10.767625+00:00'
summary: '...Optimization Strategies'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...Optimization Strategies

1. **Lazy initialization**: Don't load patterns until first use
2. **Pattern compilation**: Pre-compile all regex at init
3. **Early exit**: Skip entropy if pattern already...

---
type: patterns
timestamp: '2025-12-26T00:12:10.797187+00:00'
summary: '...**Pattern compilation**: Pre-compile all regex at init'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...**Pattern compilation**: Pre-compile all regex at init
3. **Early exit**: Skip entropy if pattern already matched
4. **Batch processing**: Share compiled patterns across captures

## Testing...

---
type: patterns
timestamp: '2025-12-26T00:12:10.823770+00:00'
summary: '...# SecretsFilteringService'
tags:
- auto-captured
- post-tool-use
- file:ARCHITECTURE.md
---

...# SecretsFilteringService
│   ├── patterns.py              # PatternDetector + pattern definitions
│   ├── entropy.py               # EntropyAnalyzer
│   ├── pii.py...

---
type: patterns
timestamp: '2025-12-26T00:15:12.990229+00:00'
summary: '...Accepted'
tags:
- auto-captured
- post-tool-use
- file:DECISIONS.md
---

...Accepted
**Deciders**: User (via elicitation)

### Context

The secrets filtering feature requires pattern matching, entropy analysis, and PII detection. Several mature libraries exist for this purpose:
-...

---
type: patterns
timestamp: '2025-12-26T00:15:47.342337+00:00'
summary: '- [ ] Multi-layer secret detection (pattern + entropy; contextual deferred
  to v2)'
tags:
- auto-captured
- post-tool-use
- file:README.md
---

- [ ] Multi-layer secret detection (pattern + entropy; contextual deferred to v2)
- [ ] PII detection (SSN, credit cards, phone numbers)
-...

---
type: patterns
timestamp: '2025-12-26T00:16:48.880073+00:00'
summary: '...(https://github.com/zircote/git-notes-memory/issues/12)'
tags:
- auto-captured
- post-tool-use
- file:CLAUDE.md
---

...(https://github.com/zircote/git-notes-memory/issues/12)
  - Features: Multi-layer secret detection (pattern + entropy), PII detection, configurable filtering strategies, allowlist management, SOC2 audit...

---
type: patterns
timestamp: '2025-12-26T00:32:13.075596+00:00'
summary: '`★ Insight ─────────────────────────────────────`

  The user''s choices are security-forward: Patter...'
tags:
- auto-captured
- pre-compact
---

`★ Insight ─────────────────────────────────────`
The user's choices are security-forward: Pattern + Entropy detection with Redact as default, plus full remediation capability. Importantly,...
