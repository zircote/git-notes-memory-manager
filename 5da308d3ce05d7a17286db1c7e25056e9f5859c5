---
type: decisions
timestamp: '2025-12-21T04:59:14.327776+00:00'
summary: '...â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`\n\n---\n\n## ðŸ“‹ DECISIONS TO CAPTURE\n\n### ADR-001:
  Git Notes as Source of Trut'
---

...â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`\n\n---\n\n## ðŸ“‹ DECISIONS TO CAPTURE\n\n### ADR-001: Git Notes as Source of Truth\n[decision] Git notes chosen as primary storage (`refs/notes/mem/{namespace}`) because they are distributed,...

---
type: decisions
timestamp: '2025-12-21T04:59:14.344884+00:00'
summary: '...18-memory-capture-plugin/ARCHITECTURE.md:85`\n\n### ADR-002: SQLite +
  sqlite-vec for Vector Searc'
---

...18-memory-capture-plugin/ARCHITECTURE.md:85`\n\n### ADR-002: SQLite + sqlite-vec for Vector Search\n[decision] Selected SQLite with sqlite-vec extension for KNN search: single file, no server, <200ms search,...

---
type: decisions
timestamp: '2025-12-21T04:59:14.364990+00:00'
summary: '...2025-12-18-memory-capture-plugin/ARCHITECTURE.md:86`\n\n### ADR-003:
  Lazy Loading of Embedding Mo'
---

...2025-12-18-memory-capture-plugin/ARCHITECTURE.md:86`\n\n### ADR-003: Lazy Loading of Embedding Model\n[decision] Defer sentence-transformers model loading until first `embed()` call to avoid 2-3 second import...

---
type: decisions
timestamp: '2025-12-21T04:59:14.384242+00:00'
summary: '...12-18-memory-capture-plugin/RETROSPECTIVE.md:67`\n\n### ADR-004: Singleton
  Service Factory Patter'
---

...12-18-memory-capture-plugin/RETROSPECTIVE.md:67`\n\n### ADR-004: Singleton Service Factory Pattern\n[decision] Use factory functions (`get_capture_service()`, `get_recall_service()`) returning singletons...

---
type: decisions
timestamp: '2025-12-21T04:59:14.402389+00:00'
summary: '...`src/git_notes_memory/__init__.py:61-122`\n\n### ADR-005: XML-Structured
  Context for Claude\n[dec'
---

...`src/git_notes_memory/__init__.py:61-122`\n\n### ADR-005: XML-Structured Context for Claude\n[decision] Use XML format (`<memory_context>`, `<working_memory>`) for hook additionalContext injectionâ€”provides...

---
type: decisions
timestamp: '2025-12-21T05:22:25.508559+00:00'
summary: '...user confirms)\n- <0.70 â†’ SKIP (no action unless explicit marker)\n-
  Explicit markers like `[deci'
---

...user confirms)\n- <0.70 â†’ SKIP (no action unless explicit marker)\n- Explicit markers like `[decision]` always treated as confidence 0.98-1.0\n\n## Related Files\n- docs/spec/completed/2025-12-19-hook-based...

---
type: decisions
timestamp: '2025-12-21T05:22:25.530116+00:00'
summary: '...recall_behaviors>` â†’ `<reference>`\n- "When you make a decision, IMMEDIATELY
  document it..." > "S'
---

...recall_behaviors>` â†’ `<reference>`\n- "When you make a decision, IMMEDIATELY document it..." > "Syntax: [decision]"\n- Context engineering: operating instructions become part of workflow\n\n## Related Files\n-...

---
type: decisions
timestamp: '2025-12-21T05:24:25.755676+00:00'
summary: '...user confirms)\n- <0.70 â†’ SKIP (no action unless explicit marker)\n-
  Explicit markers like `[deci'
---

...user confirms)\n- <0.70 â†’ SKIP (no action unless explicit marker)\n- Explicit markers like `[decision]` always treated as confidence 0.98-1.0\n\n## Related Files\n- docs/spec/completed/2025-12-19-hook-based...

---
type: decisions
timestamp: '2025-12-21T05:24:25.778190+00:00'
summary: '...recall_behaviors>` â†’ `<reference>`\n- "When you make a decision, IMMEDIATELY
  document it..." > "S'
---

...recall_behaviors>` â†’ `<reference>`\n- "When you make a decision, IMMEDIATELY document it..." > "Syntax: [decision]"\n- Context engineering: operating instructions become part of workflow\n\n## Related Files\n-...

---
type: decisions
timestamp: '2025-12-21T05:24:25.798397+00:00'
summary: '...Use markers anywhere in your messages:\n- `[remember] <insight>` - Captures
  a learning\n- `[decis'
---

...Use markers anywhere in your messages:\n- `[remember] <insight>` - Captures a learning\n- `[decision] <choice>` - Captures a decision\n- `/memory:capture <namespace> <content>` - Explicit capture\n\n**Available...

---
type: decisions
timestamp: '2025-12-21T05:31:41.523951+00:00'
summary: '...user confirms)\n- <0.70 â†’ SKIP (no action unless explicit marker)\n-
  Explicit markers like `[d...'
tags:
- auto-captured
- pre-compact
---

...user confirms)\n- <0.70 â†’ SKIP (no action unless explicit marker)\n- Explicit markers like `[decision]` always treated as confidence 0.98-1.0\n\n## Related Files\n- docs/spec/completed/2025-12-19-hook-based...

---
type: decisions
timestamp: '2025-12-21T05:31:41.545451+00:00'
summary: '...recall_behaviors>` â†’ `<reference>`\n- "When you make a decision, IMMEDIATELY
  document it..." >...'
tags:
- auto-captured
- pre-compact
---

...recall_behaviors>` â†’ `<reference>`\n- "When you make a decision, IMMEDIATELY document it..." > "Syntax: [decision]"\n- Context engineering: operating instructions become part of workflow\n\n## Related Files\n-...

---
type: decisions
timestamp: '2025-12-21T05:31:41.564887+00:00'
summary: '...Use markers anywhere in your messages:\n- `[remember] <insight>` - Captures
  a learning\n- `[de...'
tags:
- auto-captured
- pre-compact
---

...Use markers anywhere in your messages:\n- `[remember] <insight>` - Captures a learning\n- `[decision] <choice>` - Captures a decision\n- `/memory:capture <namespace> <content>` - Explicit capture\n\n**Available...

---
type: decisions
timestamp: '2025-12-21T05:39:50.735166+00:00'
summary: '...inline markers, block markers, and semantic patterns.'
tags:
- auto-captured
- post-tool-use
- file:userpromptsubmit.py
---

...inline markers, block markers, and semantic patterns.

Supported marker formats:
- Inline: [decision], [learned], [blocker], [progress], [remember]
- Block: â–¶ decision â”€â”€â”€, â–¶ learned â”€â”€â”€, etc.
-...

---
type: decisions
timestamp: '2025-12-21T05:44:15.948572+00:00'
summary: '...memories**: Use markers anywhere in your messages:

  - `[remember] <insight>` - Captures a learn...'
tags:
- auto-captured
- pre-compact
---

...memories**: Use markers anywhere in your messages:
- `[remember] <insight>` - Captures a learning
- `[decision] <choice>` - Captures a decision
- `/memory:capture <namespace> <content>` - Explicit capture

**Available...

---
type: decisions
timestamp: '2025-12-21T05:44:15.973667+00:00'
summary: 'â–¶ decision â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Git notes as source of truth, SQLite as derived ...'
tags:
- auto-captured
- pre-compact
---

Git notes as source of truth, SQLite as derived queryable index
## Context
Core architectural decision for the memory storage system. Git notes provide distributed, versioned storage that syncs with code, while SQLite + sqlite-vec provides fast KNN search.

## Rationale
- Git notes are inherently distributed (push/pull with repos)
- Version history comes free with git
- Index can be rebuilt from notes (SyncService.reindex)
- sqlite-vec enables local semantic search without external APIs

## Related Files
- docs/spec/completed/2025-12-18-memory-capture-plugin/ARCHITECTURE.md:85-91
- src/git_notes_memory/git_ops.py:1-50
- src/git_notes_memory/sync.py:1-50

---
type: decisions
timestamp: '2025-12-21T05:44:15.994022+00:00'
summary: 'â–¶ decision â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Lazy loading via __getattr__ to avoid embedding ...'
tags:
- auto-captured
- pre-compact
---

Lazy loading via __getattr__ to avoid embedding model import penalty
## Context
The sentence-transformers embedding model adds 2-3 seconds to import time. SessionStart hooks must complete quickly (<5s) to avoid blocking Claude Code sessions.

## Rationale
- Defer all expensive imports until first use
- Factory functions (`get_capture_service()`) create singletons lazily
- Direct SQLite queries in session_start_handler avoid full IndexService initialization

## Related Files
- src/git_notes_memory/__init__.py:27-85
- src/git_notes_memory/hooks/session_start_handler.py:66-89

---
type: decisions
timestamp: '2025-12-21T05:46:36.723846+00:00'
summary: '...memories**: Use markers anywhere in your messages:'
---

...memories**: Use markers anywhere in your messages:
- `[remember] <insight>` - Captures a learning
- `[decision] <choice>` - Captures a decision
- `/memory:capture <namespace> <content>` - Explicit capture

**Available...
